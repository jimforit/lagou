!function(c,a){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=c.document?a(c,!0):function(c){if(!c.document)throw new Error("Geetest requires a window with a document");return a(c)}:a(c)}("undefined"!=typeof window?window:this,function(c){"use strict";function a(c){this._obj=c}function h(c){var h=this;new a(c)._each(function(c,a){h[c]=a})}if(void 0===c)throw new Error("Geetest requires browser environment");var v=c.document,w=c.Math,y=v.getElementsByTagName("head")[0];a.prototype={_each:function(c){var a=this._obj;for(var h in a)a.hasOwnProperty(h)&&c(h,a[h]);return this}},h.prototype={api_server:"api.geetest.com",type_path:"/gettype_deepknow.php",protocol:"http://",static_servers:["static.geetest.com","dn-staticdown.qbox.me"],path:"/static/js/sense.js",type:"sense",_extend:function(c){var h=this;new a(c)._each(function(c,a){h[c]=a})}};var g=function(c){return"number"==typeof c},_=function(c){return"string"==typeof c},E=function(c){return"boolean"==typeof c},b=function(c){return"function"==typeof c},G=function(){return parseInt(1e4*w.random())+(new Date).valueOf()},j=function(c,a){var h=v.createElement("script");h.charset="UTF-8",h.async=!0,h.onerror=function(){a(!0)};var w=!1;h.onload=h.onreadystatechange=function(){w||h.readyState&&"loaded"!==h.readyState&&"complete"!==h.readyState||(w=!0,setTimeout(function(){a(!1)},0))},h.src=c,y.appendChild(h)},k=function(c){return c.replace(/^https?:\/\/|\/$/g,"")},I=function(c){return c=c.replace(/\/+/g,"/"),0!==c.indexOf("/")&&(c="/"+c),c},N=function(c){if(!c)return"";var q="?";return new a(c)._each(function(c,a){(_(a)||g(a)||E(a))&&(q=q+encodeURIComponent(c)+"="+encodeURIComponent(a)+"&")}),"?"===q&&(q=""),q.replace(/&$/,"")},S=function(c,a,h,v){a=k(a);var w=I(h)+N(v);return a&&(w=c+a+w),w},C=function(c,a,h,v,w){var y=function(g){var _=S(c,a[g],h,v);j(_,function(c){c?g>=a.length-1?w(!0):y(g+1):w(!1)})};y(0)},O=function(a,h,v,w){var y="geetest_"+G();c[y]=function(a){w("success"===a.status?a.data:a),c[y]=void 0;try{delete c[y]}catch(e){}},C(v.protocol,a,h,{gt:v.id,callback:y},function(c){c&&T("networkError",v)})},T=function(c,a){var h={networkError:"网络错误",idNotExist:"参数id必填",cbIlegal:"callback必须是function",geetestNotExist:"Geetest不存在"};if("function"!=typeof a.onError)throw new Error(h[c]);a.onError(h[c])},U=function(){return!!c.Geetest},R=function(a,v){var w=new h(a);return w.protocol=a.https?"https://":"http:"!==c.location.protocol&&"https:"!==c.location.protocol?"https://":c.location.protocol+"//",a&&a.id?v&&!b(v)?void T("cbIlegal",w):U()?void(v&&v(new c.Geetest(w))):void O([w.api_server],w.type_path,w,function(a){C(w.protocol,a.static_servers,a.path,null,function(h){if(h)T("networkError",w);else{if("undefined"==typeof c.Geetest)return void T("geetestNotExist",w);w._extend(a),v&&v(new c.Geetest(w))}})}):void T("idNotExist",w)};return c.initSense=R,R});